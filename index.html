<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Test Unit 21 & 22 - Ms H·∫£i</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --success: #00D26A;
            --error: #FF4757;
            --warning: #FFD32A;
            --bg: #fdf2f8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(var(--primary) 0.5px, transparent 0.5px), radial-gradient(var(--secondary) 0.5px, var(--bg) 0.5px);
            background-size: 25px 25px;
            margin: 0; padding: 0;
            overflow-x: hidden;
            -webkit-user-select: none; user-select: none;
        }

        /* Anti-Cheat Layer */
        #anti-cheat-layer {
            display: none; position: fixed; inset: 0; background: rgba(255, 71, 87, 0.98);
            color: white; z-index: 10000; flex-direction: column; justify-content: center;
            align-items: center; text-align: center; font-size: 1.5rem; font-weight: 800;
        }

        /* Start Screen */
        #start-screen {
            position: fixed; inset: 0; background: var(--primary);
            z-index: 9999; display: flex; justify-content: center; align-items: center;
        }
        .login-box {
            background: white; padding: 40px; border-radius: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; width: 90%; max-width: 450px;
        }
        .login-box input {
            width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 20px;
            font-family: inherit; font-size: 1.1rem; margin-bottom: 20px; box-sizing: border-box;
        }

        /* Header */
        header {
            background: white; padding: 10px 30px; position: sticky; top: 0;
            z-index: 1000; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            display: flex; justify-content: space-between; align-items: center;
        }
        .timer-box { font-size: 1.5rem; font-weight: 800; color: var(--error); background: #fff0f0; padding: 5px 20px; border-radius: 15px; border: 2px solid var(--error); }

        /* Container & Cards */
        .container { max-width: 900px; margin: 30px auto; padding: 0 20px 150px; }
        .card {
            background: white; border-radius: 25px; padding: 30px; margin-bottom: 30px;
            box-shadow: 0 8px 0 #e0e0e0; position: relative; border: 2px solid #f0f0f0;
        }
        .section-title { color: var(--primary); border-bottom: 4px solid var(--secondary); display: inline-block; margin-bottom: 25px; font-weight: 800; text-transform: uppercase; }

        /* Interactive Elements */
        .q-text { font-size: 1.15rem; font-weight: 700; margin-bottom: 15px; color: #2d3436; }
        .option-btn {
            display: block; width: 100%; padding: 15px 20px; margin: 12px 0;
            background: white; border: 2px solid #e0e0e0; border-radius: 20px;
            text-align: left; font-family: inherit; font-size: 1rem; font-weight: 700;
            cursor: pointer; box-shadow: 0 5px 0 #e0e0e0; transition: 0.2s;
        }
        .option-btn:hover:not(:disabled) { transform: scale(1.02); background: #f9f9f9; }
        .option-btn.selected { border-color: var(--primary); background: #f3ebff; }
        .option-btn.correct { background: var(--success) !important; color: white; border-color: #00a352; box-shadow: 0 5px 0 #008141; }
        .option-btn.wrong { background: var(--error) !important; color: white; border-color: #d63031; box-shadow: 0 5px 0 #af2323; animation: shake 0.4s; }

        .check-btn { background: var(--secondary); color: white; border: none; padding: 10px 25px; border-radius: 15px; font-weight: 800; cursor: pointer; box-shadow: 0 4px 0 #008f76; margin-top: 10px; }
        .explanation { display: none; margin-top: 20px; padding: 20px; background: #fdf2ff; border-left: 6px solid var(--primary); border-radius: 15px; font-size: 0.95rem; line-height: 1.6; animation: fadeIn 0.5s; }

        input[type="text"] { width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 20px; font-family: inherit; font-size: 1rem; box-sizing: border-box; }

        /* Footer */
        .footer { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 20px; display: flex; justify-content: center; box-shadow: 0 -5px 15px rgba(0,0,0,0.1); z-index: 1000; }
        .submit-all { background: var(--primary); color: white; border: none; padding: 18px 80px; border-radius: 50px; font-size: 1.3rem; font-weight: 800; cursor: pointer; box-shadow: 0 6px 0 #5d3985; transition: 0.2s; }
        .submit-all:hover { transform: translateY(-3px); box-shadow: 0 9px 0 #5d3985; }

        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-10px);} 75% {transform: translateX(10px);} }
        @keyframes fadeIn { from {opacity: 0;} to {opacity: 1;} }
        .warning-card { border: 3px solid var(--warning) !important; background: #fffdf2 !important; }
    </style>
</head>
<body>

<div id="anti-cheat-layer">
    <h1>‚ö†Ô∏è C·∫¢NH B√ÅO GIAN L·∫¨N!</h1>
    <p>Con ƒë√£ tho√°t kh·ªèi b√†i thi! Quay l·∫°i ngay l·∫≠p t·ª©c.</p>
    <button class="check-btn" style="background: white; color: var(--error);" onclick="hideCheat()">Con cam k·∫øt kh√¥ng gian l·∫≠n ·∫°!</button>
</div>

<div id="start-screen">
    <div class="login-box">
        <h1 style="color:var(--primary); margin-top: 0;">L·ªöP C√î H·∫¢I üåü</h1>
        <p>Ki·ªÉm tra Unit 21 & 22 (Reported Speech & Money)</p>
        <input type="text" id="student-name" placeholder="H·ªç v√† t√™n c·ªßa con...">
        <button class="submit-all" onclick="startQuiz()">B·∫ÆT ƒê·∫¶U (30 PH√öT) üöÄ</button>
    </div>
</div>

<header>
    <div>HS: <b id="display-name">---</b></div>
    <div class="timer-box" id="time-left">30:00</div>
</header>

<div class="container">
    <div class="card">
        <h3 class="section-title">I. VOCABULARY: Labeling</h3>
        <p><i>receipt ‚Ä¢ credit card ‚Ä¢ banknote ‚Ä¢ discount ‚Ä¢ checkout</i></p>
        
        <div class="q-block" data-ans="credit card">
            <p class="q-text">1. üí≥ (Th·∫ª d√πng ƒë·ªÉ thanh to√°n thay ti·ªÅn m·∫∑t):</p>
            <input type="text" placeholder="Nh·∫≠p t·ª´ v·ª±ng...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> Th·∫ª t√≠n d·ª•ng. <b>T·∫°i sao ƒë√∫ng:</b> ƒê√¢y l√† v·∫≠t d·ª•ng thanh to√°n kh√¥ng d√πng ti·ªÅn m·∫∑t ph·ªï bi·∫øn.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="receipt">
            <p class="q-text">2. üßæ (T·ªù phi·∫øu x√°c nh·∫≠n b·∫°n ƒë√£ tr·∫£ ti·ªÅn cho m√≥n h√†ng):</p>
            <input type="text" placeholder="Nh·∫≠p t·ª´ v·ª±ng...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> H√≥a ƒë∆°n/Bi√™n lai. <b>T·∫°i sao ƒë√∫ng:</b> D√πng ƒë·ªÉ x√°c nh·∫≠n giao d·ªãch th√†nh c√¥ng.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="banknote">
            <p class="q-text">3. üíµ (Ti·ªÅn l√†m b·∫±ng gi·∫•y ho·∫∑c polyme):</p>
            <input type="text" placeholder="Nh·∫≠p t·ª´ v·ª±ng...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> Ti·ªÅn gi·∫•y. <b>T·∫°i sao ƒë√∫ng:</b> Kh√°c v·ªõi coins (ti·ªÅn xu).</div>
        </div>
        <hr>
        <div class="q-block" data-ans="discount">
            <p class="q-text">4. üè∑Ô∏è -30% (S·ª± gi·∫£m gi√° so v·ªõi gi√° g·ªëc):</p>
            <input type="text" placeholder="Nh·∫≠p t·ª´ v·ª±ng...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> Gi·∫£m gi√°/Chi·∫øt kh·∫•u. <b>T·∫°i sao ƒë√∫ng:</b> Th·ªÉ hi·ªán s·ª± gi·∫£m b·ªõt v·ªÅ gi√° b√°n.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="checkout">
            <p class="q-text">5. üõí (N∆°i b·∫°n x·∫øp h√†ng ƒë·ªÉ thanh to√°n trong si√™u th·ªã):</p>
            <input type="text" placeholder="Nh·∫≠p t·ª´ v·ª±ng...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> Qu·∫ßy thanh to√°n. <b>T·∫°i sao ƒë√∫ng:</b> N∆°i ho√†n t·∫•t vi·ªác mua s·∫Øm.</div>
        </div>
    </div>

    <div class="card">
        <h3 class="section-title">II. MULTIPLE CHOICE</h3>
        <div class="q-block-mc" data-ans="C">
            <p class="q-text">6. Tim said he __________ about buying a car for a long time.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. thinks</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. is thinking</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. had been thinking</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. has thought</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: Tim n√≥i r·∫±ng c·∫≠u ·∫•y ƒë√£ ƒëang suy nghƒ© v·ªÅ vi·ªác mua √¥ t√¥ trong m·ªôt th·ªùi gian d√†i.<br>
                <b>B∆∞·ªõc 2:</b> A. nghƒ© (HTƒê); B. ƒëang nghƒ© (HTTD); C. ƒë√£ ƒëang nghƒ© (QKHTTD); D. ƒë√£ nghƒ© (HTHT).<br>
                <b>B∆∞·ªõc 3:</b> C·∫•u tr√∫c Reported Speech: Khi ƒë·ªông t·ª´ d·∫´n l√† "said", ta ph·∫£i l√πi th√¨. Th√¨ g·ªëc l√† HTHTTD "has been thinking" l√πi v·ªÅ <b>QKHTTD</b>.<br>
                <b>B∆∞·ªõc 4:</b> A, B, D ch∆∞a l√πi th√¨ ph√π h·ª£p.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="B">
            <p class="q-text">7. I think you'll find that this car is very __________ to drive.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. economic</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. economical</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. economy</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. finance</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: T√¥i nghƒ© b·∫°n s·∫Ω th·∫•y chi·∫øc xe n√†y l√°i r·∫•t ti·∫øt ki·ªám.<br>
                <b>B∆∞·ªõc 2:</b> A. thu·ªôc kinh t·∫ø; B. ti·∫øt ki·ªám; C. n·ªÅn kinh t·∫ø; D. t√†i ch√≠nh.<br>
                <b>B∆∞·ªõc 3:</b> <b>Economical</b> mang nghƒ©a ti·∫øt ki·ªám ti·ªÅn b·∫°c/nhi√™n li·ªáu.<br>
                <b>B∆∞·ªõc 4:</b> Economic d√πng cho h·ªá th·ªëng kinh t·∫ø qu·ªëc gia. C v√† D l√† danh t·ª´.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="A">
            <p class="q-text">8. Julian wanted to know __________ he could meet Doug at six o'clock.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. whether</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. that</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. what</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. which</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: Julian mu·ªën bi·∫øt li·ªáu anh ·∫•y c√≥ th·ªÉ g·∫∑p Doug l√∫c 6 gi·ªù kh√¥ng.<br>
                <b>B∆∞·ªõc 2:</b> A. li·ªáu r·∫±ng; B. r·∫±ng; C. c√°i g√¨; D. c√°i n√†o.<br>
                <b>B∆∞·ªõc 3:</b> ƒê√¢y l√† c√¢u h·ªèi Yes/No gi√°n ti·∫øp, d√πng <b>Whether/If</b>.<br>
                <b>B∆∞·ªõc 4:</b> That d√πng cho c√¢u k·ªÉ. What/Which d√πng cho c√¢u h·ªèi c√≥ t·ª´ ƒë·ªÉ h·ªèi.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="C">
            <p class="q-text">9. I try to __________ a little money each month to spend on a holiday.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. bank on</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. get through</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. put by</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. come by</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: T√¥i c·ªë g·∫Øng ƒë·ªÉ d√†nh m·ªôt √≠t ti·ªÅn m·ªói th√°ng ƒë·ªÉ ƒëi ngh·ªâ m√°t.<br>
                <b>B∆∞·ªõc 2:</b> A. d·ª±a d·∫´m; B. ho√†n th√†nh/v∆∞·ª£t qua; C. ƒë·ªÉ d√†nh; D. c√≥ ƒë∆∞·ª£c.<br>
                <b>B∆∞·ªõc 3:</b> <b>Put by</b> = save money for later (ti·∫øt ki·ªám/ƒë·ªÉ d√†nh).<br>
                <b>B∆∞·ªõc 4:</b> C√°c c·ª•m ƒë·ªông t·ª´ kh√°c kh√¥ng mang nghƒ©a ti·∫øt ki·ªám ti·ªÅn.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="D">
            <p class="q-text">10. The hotel __________ us ¬£50 for using the swimming pool.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. cost</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. paid</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. spent</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. charged</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: Kh√°ch s·∫°n ƒë√£ thu ch√∫ng t√¥i 50 b·∫£ng ph√≠ s·ª≠ d·ª•ng b·ªÉ b∆°i.<br>
                <b>B∆∞·ªõc 2:</b> A. tr·ªã gi√°; B. tr·∫£; C. ti√™u; D. thu ph√≠.<br>
                <b>B∆∞·ªõc 3:</b> C·∫•u tr√∫c: <b>Charge someone money for something</b> (Thu ph√≠ ai bao nhi√™u cho vi·ªác g√¨).<br>
                <b>B∆∞·ªõc 4:</b> Cost ƒëi v·ªõi v·∫≠t l√†m ch·ªß ng·ªØ. Paid/Spent d√πng sai c·∫•u tr√∫c gi·ªõi t·ª´.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="B">
            <p class="q-text">11. Our teacher said that Shakespeare __________ the greatest English writer.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. is</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. was</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. has been</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. will be</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: Gi√°o vi√™n n√≥i r·∫±ng Shakespeare l√† nh√† vƒÉn Anh vƒ© ƒë·∫°i nh·∫•t.<br>
                <b>B∆∞·ªõc 2:</b> A. hi·ªán t·∫°i; B. qu√° kh·ª©; C. HTHT; D. t∆∞∆°ng lai.<br>
                <b>B∆∞·ªõc 3:</b> Shakespeare s·ªëng trong qu√° kh·ª© n√™n khi t∆∞·ªùng thu·∫≠t l·∫°i v·∫´n d√πng <b>was</b>.<br>
                <b>B∆∞·ªõc 4:</b> Is sai v√¨ √¥ng ƒë√£ m·∫•t. C√°c th√¨ kh√°c kh√¥ng h·ª£p ng·ªØ c·∫£nh.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="B">
            <p class="q-text">12. My mother suddenly came __________ a fortune when her aunt died.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. across</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. into</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. by</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. up</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: M·∫π t√¥i b·ªóng d∆∞ng th·ª´a k·∫ø m·ªôt gia t√†i khi d√¨ c·ªßa b√† qua ƒë·ªùi.<br>
                <b>B∆∞·ªõc 2:</b> A. t√¨nh c·ªù g·∫∑p; B. th·ª´a k·∫ø; C. c√≥ ƒë∆∞·ª£c; D. x·∫£y ra.<br>
                <b>B∆∞·ªõc 3:</b> Phrasal verb: <b>Come into</b> = inherit (th·ª´a k·∫ø).<br>
                <b>B∆∞·ªõc 4:</b> Come across d√πng cho v·∫≠t/ng∆∞·ªùi t√¨nh c·ªù th·∫•y.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="C">
            <p class="q-text">13. The bank __________ to answer even a simple question about my loan.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. denied</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. suggested</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. refused</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. stated</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: Ng√¢n h√†ng ƒë√£ t·ª´ ch·ªëi tr·∫£ l·ªùi d√π l√† c√¢u h·ªèi ƒë∆°n gi·∫£n nh·∫•t v·ªÅ kho·∫£n vay c·ªßa t√¥i.<br>
                <b>B∆∞·ªõc 2:</b> A. ph·ªß nh·∫≠n; B. g·ª£i √Ω; C. t·ª´ ch·ªëi; D. ph√°t bi·ªÉu.<br>
                <b>B∆∞·ªõc 3:</b> C·∫•u tr√∫c <b>Refuse + to Verb</b> (T·ª´ ch·ªëi l√†m g√¨).<br>
                <b>B∆∞·ªõc 4:</b> Deny/Suggest ƒëi v·ªõi V-ing. State ƒëi v·ªõi clause.
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="C">
            <p class="q-text">14. "I'll go shopping tomorrow," said Tim. ‚Üí Tim said he would go shopping __________.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. tomorrow</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. the day before</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. the next day</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. two days ago</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: "T√¥i s·∫Ω ƒëi mua s·∫Øm v√†o ng√†y mai," Tim n√≥i.<br>
                <b>B∆∞·ªõc 3:</b> Trong c√¢u gi√°n ti·∫øp, <b>tomorrow</b> ƒë·ªïi th√†nh <b>the next day</b> ho·∫∑c <b>the following day</b>.<br>
                <b>B∆∞·ªõc 4:</b> A ch∆∞a ƒë·ªïi. B l√† "h√¥m tr∆∞·ªõc". D l√† "hai ng√†y tr∆∞·ªõc".
            </div>
        </div>
        <hr>
        <div class="q-block-mc" data-ans="B">
            <p class="q-text">15. Do you have __________ for a fifty-pound note? I need some coins.</p>
            <button class="option-btn" onclick="sel(this, 'A')">A. cash</button>
            <button class="option-btn" onclick="sel(this, 'B')">B. change</button>
            <button class="option-btn" onclick="sel(this, 'C')">C. currency</button>
            <button class="option-btn" onclick="sel(this, 'D')">D. bill</button>
            <button class="check-btn" onclick="checkInPlaceMC(this)">CHECK</button>
            <div class="explanation">
                <b>B∆∞·ªõc 1:</b> D·ªãch: B·∫°n c√≥ ti·ªÅn l·∫ª cho t·ªù 50 b·∫£ng kh√¥ng? T√¥i c·∫ßn m·∫•y ƒë·ªìng xu.<br>
                <b>B∆∞·ªõc 3:</b> <b>Change</b> nghƒ©a l√† ti·ªÅn l·∫ª/ti·ªÅn th·ªëi l·∫°i.<br>
                <b>B∆∞·ªõc 4:</b> Cash l√† ti·ªÅn m·∫∑t n√≥i chung. Currency l√† ƒë∆°n v·ªã ti·ªÅn t·ªá. Bill l√† h√≥a ƒë∆°n/t·ªù ti·ªÅn gi·∫•y.
            </div>
        </div>
    </div>

    <div class="card">
        <h3 class="section-title">III. CLOZE TEST: Reading</h3>
        <p style="line-height: 1.8; background: #f9f9f9; padding: 20px; border-radius: 15px; border: 2px dashed var(--primary);">
            Last week, my friend Sarah told me she (16) _____ planning a big party. She said she (17) _____ a lot of money on decorations (18) _____. I (19) _____ her if she needed any (20) _____, and she admitted that she was (21) _____ of money. I (22) _____ her to look for some (23) _____ in the local shops where things are cheaper.
        </p>
        <div id="reading-questions">
            <div class="q-block-mc" data-ans="B">
                <p>16.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. is</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. was</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. has been</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. will be</button>
                <div class="explanation"><b>D·∫´n ch·ª©ng:</b> "told me she <b>was</b> planning" (D·ªãch: n√≥i v·ªõi t√¥i c√¥ ·∫•y ƒëang l√™n k·∫ø ho·∫°ch). C·∫•u tr√∫c gi√°n ti·∫øp l√πi t·ª´ HTTD v·ªÅ QKTD.</div>
            </div>
            <div class="q-block-mc" data-ans="C" style="margin-top:20px;">
                <p>17.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. spends</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. spent</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. had spent</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. is spending</button>
                <div class="explanation"><b>D·∫´n ch·ª©ng:</b> "had spent a lot of money" (D·ªãch: ƒë√£ ti√™u r·∫•t nhi·ªÅu ti·ªÅn). L√πi th√¨ t·ª´ QKƒê v·ªÅ QKHT.</div>
            </div>
            <div class="q-block-mc" data-ans="B" style="margin-top:20px;">
                <p>18.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. yesterday</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. the day before</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. tomorrow</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. following day</button>
                <div class="explanation"><b>D·∫´n ch·ª©ng:</b> <b>the day before</b> (h√¥m tr∆∞·ªõc ƒë√≥). ƒê·ªïi t·ª´ yesterday trong c√¢u gi√°n ti·∫øp.</div>
            </div>
            <div class="q-block-mc" data-ans="C" style="margin-top:20px;">
                <p>19.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. said</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. told</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. asked</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. claimed</button>
                <div class="explanation"><b>D·∫´n ch·ª©ng:</b> "I <b>asked</b> her if..." (D·ªãch: T√¥i ƒë√£ h·ªèi c√¥ ·∫•y li·ªáu...). C·∫•u tr√∫c c√¢u h·ªèi gi√°n ti·∫øp Yes/No.</div>
            </div>
            <div class="q-block-mc" data-ans="B" style="margin-top:20px;">
                <p>20.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. assist</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. assistance</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. assistant</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. assisted</button>
                <div class="explanation"><b>D·∫´n ch·ª©ng:</b> "needed any <b>assistance</b>" (D·ªãch: c·∫ßn b·∫•t k·ª≥ s·ª± h·ªó tr·ª£ n√†o). Sau "any" + danh t·ª´.</div>
            </div>
            <div class="q-block-mc" data-ans="C" style="margin-top:20px;">
                <p>21.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. debt</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. lack</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. short</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. poor</button>
                <div class="explanation"><b>D·∫´n ch·ª©ng:</b> <b>short of money</b> (D·ªãch: thi·∫øu ti·ªÅn). C·ª•m c·ªë ƒë·ªãnh: be short of something.</div>
            </div>
            <div class="q-block-mc" data-ans="A" style="margin-top:20px;">
                <p>22.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. suggested</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. told</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. said</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. ordered</button>
                <div class="explanation"><b>D·∫´n ch·ª©ng:</b> "I <b>suggested</b> her to..." (D·ªãch: T√¥i g·ª£i √Ω c√¥ ·∫•y...). G·ª£i √Ω h√†nh ƒë·ªông.</div>
            </div>
            <div class="q-block-mc" data-ans="A" style="margin-top:20px;">
                <p>23.</p>
                <button class="option-btn" onclick="sel(this, 'A')">A. bargains</button>
                <button class="option-btn" onclick="sel(this, 'B')">B. debts</button>
                <button class="option-btn" onclick="sel(this, 'C')">C. fortunes</button>
                <button class="option-btn" onclick="sel(this, 'D')">D. bills</button>
                <div class="explanation"><b>D·ªãch:</b> "look for some <b>bargains</b>" (t√¨m m√≥n h·ªùi). Mua ƒë·ªì r·∫ª ·ªü shop ƒë·ªãa ph∆∞∆°ng.</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h3 class="section-title">IV. WORD FORMATION</h3>
        <div class="q-block" data-ans="investment">
            <p class="q-text">24. Western financial __________ in developing countries is very important. (INVEST)</p>
            <input type="text" placeholder="Nh·∫≠p ƒë√°p √°n...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> S·ª± ƒë·∫ßu t∆∞ t√†i ch√≠nh. <b>Gi·∫£i th√≠ch:</b> Sau t√≠nh t·ª´ "financial" c·∫ßn danh t·ª´. <b>Investment</b> l√† danh t·ª´ c·ªßa Invest.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="poverty">
            <p class="q-text">25. Millions of people in the world still live in extreme __________. (POOR)</p>
            <input type="text" placeholder="Nh·∫≠p ƒë√°p √°n...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> S·ª± ngh√®o kh·ªï. <b>Gi·∫£i th√≠ch:</b> Sau t√≠nh t·ª´ "extreme" c·∫ßn danh t·ª´. <b>Poverty</b> l√† danh t·ª´ c·ªßa Poor.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="unacceptable">
            <p class="q-text">26. The increase in prices at the shop was totally __________. (ACCEPT)</p>
            <input type="text" placeholder="Nh·∫≠p ƒë√°p √°n...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> Kh√¥ng th·ªÉ ch·∫•p nh·∫≠n ƒë∆∞·ª£c. <b>Gi·∫£i th√≠ch:</b> C·∫ßn t√≠nh t·ª´ ƒë·ª©ng sau to-be. TƒÉng gi√° th∆∞·ªùng mang nghƒ©a ti√™u c·ª±c -> <b>Unacceptable</b>.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="wealthy">
            <p class="q-text">27. There are many problems connected to being extremely __________. (WEALTH)</p>
            <input type="text" placeholder="Nh·∫≠p ƒë√°p √°n...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>D·ªãch:</b> Gi√†u c√≥. <b>Gi·∫£i th√≠ch:</b> Sau tr·∫°ng t·ª´ "extremely" c·∫ßn t√≠nh t·ª´. <b>Wealthy</b> l√† t√≠nh t·ª´ c·ªßa Wealth.</div>
        </div>
    </div>

    <div class="card">
        <h3 class="section-title">V. SENTENCE TRANSFORMATION</h3>
        <div class="q-block" data-ans="liz said that she had had evan over for dinner the night before">
            <p class="q-text">28. "I had Evan over for dinner last night," said Liz.</p>
            <input type="text" placeholder="Vi·∫øt l·∫°i c√¢u: Liz said that...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>ƒê√°p √°n ƒë√∫ng:</b> Liz said that she had had Evan over for dinner the night before.<br><b>Ph√¢n t√≠ch:</b> L√πi th√¨ QKƒê -> QKHT. ƒê·ªïi last night -> the night before.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="george and kevins father told them that he could pick them up from school">
            <p class="q-text">29. "I can pick you boys up from school," said their father to George and Kevin.</p>
            <input type="text" placeholder="Vi·∫øt l·∫°i c√¢u: George and Kevin's father told them that...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>ƒê√°p √°n ƒë√∫ng:</b> George and Kevin's father told them that he could pick them up from school.<br><b>Ph√¢n t√≠ch:</b> Can -> Could. ƒê·ªïi ƒë·∫°i t·ª´ I -> he, you -> them.</div>
        </div>
        <hr>
        <div class="q-block" data-ans="i didnt want to be in debt to sue so i didnt borrow any money">
            <p class="q-text">30. I didn't want to owe Sue money, so I didn't borrow any.</p>
            <input type="text" placeholder="Vi·∫øt l·∫°i c√¢u: I didn't want to...">
            <button class="check-btn" onclick="checkInPlace(this)">CHECK</button>
            <div class="explanation"><b>ƒê√°p √°n ƒë√∫ng:</b> I didn't want to be in debt to Sue, so I didn't borrow any (money).<br><b>Ph√¢n t√≠ch:</b> C·∫•u tr√∫c "be in debt to someone" (m·∫Øc n·ª£ ai) ƒë·ªìng nghƒ©a v·ªõi "owe someone money".</div>
        </div>
    </div>
</div>

<div class="footer"><button class="submit-all" onclick="finishQuiz()">N·ªòP B√ÄI T·∫§T C·∫¢ üèÜ</button></div>

<div id="result-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:20000; justify-content:center; align-items:center;">
    <div class="card" style="text-align:center; max-width:450px; width:90%;">
        <h1 id="score-display" style="font-size:3.5rem; color:var(--primary); margin:10px 0;">0/30</h1>
        <p id="feedback-msg" style="font-size:1.2rem; font-weight:700;"></p>
        <button class="submit-all" style="margin-top:20px;" onclick="location.reload()">L√ÄM L·∫†I üîÑ</button>
    </div>
</div>

<div id="anti-cheat" style="display:none; position:fixed; inset:0; background:rgba(255, 71, 87, 0.98); color:white; z-index:10000; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding: 20px;">
    <h1>‚ö†Ô∏è C·∫¢NH B√ÅO GIAN L·∫¨N!</h1>
    <p>Con ƒë√£ tho√°t kh·ªèi b√†i thi! Quay l·∫°i ngay l·∫≠p t·ª©c.</p>
    <button class="check-btn" style="background: white; color: var(--error);" onclick="document.getElementById('anti-cheat').style.display='none'">Con cam k·∫øt kh√¥ng gian l·∫≠n!</button>
</div>

<audio id="snd-ding" src="https://www.soundjay.com/buttons/sounds/button-3.mp3"></audio>
<audio id="snd-wrong" src="https://www.soundjay.com/misc/sounds/fail-trombone-01.mp3"></audio>

<script>
    let timeLeft = 1800;
    let timerId;
    let studentName = "";
    let startTime;
    let quizActive = false;
    let resultsLog = [];

    function startQuiz() {
        const nameInput = document.getElementById('student-name');
        if (!nameInput.value.trim()) { alert("Nh·∫≠p t√™n ƒë√£ con ∆°i!"); return; }
        studentName = nameInput.value;
        document.getElementById('display-name').innerText = studentName;
        document.getElementById('start-screen').style.display = 'none';
        startTime = new Date().toLocaleString();
        quizActive = true;
        
        const docEl = document.documentElement;
        if (docEl.requestFullscreen) docEl.requestFullscreen();
        
        startTimer();
    }

    function startTimer() {
        timerId = setInterval(() => {
            if(!quizActive) return;
            timeLeft--;
            let mins = Math.floor(timeLeft / 60);
            let secs = timeLeft % 60;
            document.getElementById('time-left').innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            if (timeLeft <= 0) { clearInterval(timerId); finishQuiz(); }
        }, 1000);
    }

    document.addEventListener("visibilitychange", () => {
        if (document.hidden && quizActive) document.getElementById('anti-cheat').style.display = 'flex';
    });

    function sel(btn, val) {
        const parent = btn.parentElement;
        parent.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        btn.dataset.val = val;
    }

    function checkInPlace(btn) {
        const block = btn.parentElement;
        const input = block.querySelector('input');
        const correct = block.dataset.ans.toLowerCase();
        const exp = block.querySelector('.explanation');
        
        if (input.value.toLowerCase().trim().replace(/\s+/g, ' ') === correct) {
            input.style.borderColor = "var(--success)";
            document.getElementById('snd-ding').play();
            confetti({ particleCount: 50, spread: 60, origin: { y: 0.8 } });
        } else {
            input.style.borderColor = "var(--error)";
            document.getElementById('snd-wrong').play();
        }
        exp.style.display = "block";
    }

    function checkInPlaceMC(btn) {
        const block = btn.parentElement;
        const correct = block.dataset.ans;
        const selected = block.querySelector('.option-btn.selected');
        const exp = block.querySelector('.explanation');
        
        block.querySelectorAll('.option-btn').forEach(b => {
            if(b.innerText.startsWith(correct)) b.classList.add('correct');
            if(b.classList.contains('selected') && !b.innerText.startsWith(correct)) b.classList.add('wrong');
            b.disabled = true;
        });

        if (selected && selected.dataset.val === correct) {
            document.getElementById('snd-ding').play();
            confetti({ particleCount: 50, spread: 60, origin: { y: 0.8 } });
        } else {
            document.getElementById('snd-wrong').play();
        }
        exp.style.display = "block";
    }

    function finishQuiz() {
        quizActive = false;
        clearInterval(timerId);
        let score = 0;
        const total = 30;

        document.querySelectorAll('.q-block, .q-block-mc').forEach(q => {
            const correct = q.dataset.ans;
            const exp = q.querySelector('.explanation');
            exp.style.display = "block";

            if(q.classList.contains('q-block')) {
                const input = q.querySelector('input');
                if(input.value.toLowerCase().trim().replace(/\s+/g, ' ') === correct.toLowerCase()) score++;
                else if(!input.value) q.classList.add('warning-card');
            } else {
                const sel = q.querySelector('.option-btn.selected');
                if(sel && sel.dataset.val === correct) score++;
                else if(!sel) q.classList.add('warning-card');
                
                q.querySelectorAll('.option-btn').forEach(b => {
                    if(b.innerText.startsWith(correct)) b.classList.add('correct');
                    b.disabled = true;
                });
            }
        });

        document.getElementById('score-display').innerText = `${score}/${total}`;
        document.getElementById('feedback-msg').innerText = score >= 24 ? "Tuy·ªát v·ªùi! Con ƒë√∫ng l√† thi√™n t√†i! üåü" : "C·ªë g·∫Øng l√™n nh√©! Xem k·ªπ gi·∫£i th√≠ch ƒë·ªÉ gi·ªèi h∆°n! üí™";
        document.getElementById('result-modal').style.display = "flex";
        
        if (score >= 24) confetti({ particleCount: 200, spread: 100 });
        saveAndExport(score, total);
    }

    function saveAndExport(score, total) {
        const endTime = new Date().toLocaleString();
        const duration = 1800 - timeLeft;
        const min = Math.floor(duration/60);
        const sec = duration % 60;
        
        const data = [
            ["T√™n H·ªçc Sinh", "Th·ªùi Gian B·∫Øt ƒê·∫ßu", "Th·ªùi Gian N·ªôp", "Th·ªùi Gian L√†m", "C√¢u ƒê√∫ng", "T·ªïng C√¢u"],
            [studentName, startTime, endTime, `${min}m ${sec}s`, score, total]
        ];

        const ws = XLSX.utils.aoa_to_sheet(data);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "KetQua");
        XLSX.writeFile(wb, `KetQua_${studentName}.xlsx`);
    }
</script>

</body>
</html>